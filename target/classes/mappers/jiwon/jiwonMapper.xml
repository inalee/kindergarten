<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
    <!-- mapper는 sql쿼리 작성 및 저장 용도 -->
  <mapper namespace="com.jiwon.mapper.jiwonMapper"> <!-- namespace는 패키지와 유사한 용도임 -->

<!--  kincode로 해당 유치원의 반 목록를 불러움 -->
  <select id="getClassList" resultType="ClassVO">
  	<![CDATA[select clcode, clname, kincode from class where kincode=#{kincode}]]>
  </select>
   <select id="getClassMember" resultType="ChildrenVO">
  		select ccode, cname from children where clcode = #{clcode}
  </select>
<!--   반이 1개 이상 있는 유치원의 목록을 가져옴 -->
    <select id="getKinderList" resultType="int">
  	select k.kincode from kindergarten k, class c where c.kincode = k.kincode  group by kincode order by kincode
  </select>
<!--   하루의 마지막에 학생들의 출결정보 저장 -->
  <insert id="insertACheck">
  	insert into attend (atdate, ccode, atstime, atetime, atstate) values(#{atdate},#{ccode},#{atstime},#{atetime},#{atstate})
  </insert>
<!--   해당 반의 한달동안 출결정보를 가져옴 -->
  <select id="getAttendByMonth" resultType="AttendDTO"><!-- 0801 추가 -->
  	select a.atdate, a.ccode, a.atstate from attend a, class c, children ch where atdate like concat(#{atmonth},'%') and c.clcode=ch.clcode and ch.ccode = a.ccode and ch.clcode=#{clcode} order by atdate;
  </select>
  
<!--   해당 학부모의 아이 리스트를 가져옴 -->
	<select id="getChildrenList" resultType="ChildrenVO">
		select ch.ccode, ch.kincode, ch.clcode, ch.cname from children ch, guardian g where g.memid = #{memid} and ch.gcode = g.gcode;
	</select>
<!-- 	해당 아이의 정보를 가져옴 -->
	<select id="getChildInfo" resultType="ChildrenDTO">
		select k.kinname, cl.clname, ch.cname, ch.ccode from kindergarten k, class cl, children ch where ch.ccode=#{ccode} and k.kincode=cl.kincode and cl.clcode=ch.clcode
	</select>
<!--  영상을 클릭하면 영상 정보 저장 -->
  <insert id="insertVideoInfo">
  	insert into videoinfo(ccode, vname, vchannel, vid, vkeyword) values(#{ccode},#{vname},#{vchannel},#{vid}, #{vkeyword})
  </insert>
  </mapper>